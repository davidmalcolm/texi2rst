

<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN"
  "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">


<html xmlns="http://www.w3.org/1999/xhtml">
  <head>
    <meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
    
    <title>Interoperation &mdash; gcc 6 documentation</title>
    
    <link rel="stylesheet" href="_static/sphinxdoc.css" type="text/css" />
    <link rel="stylesheet" href="_static/pygments.css" type="text/css" />
    
    <script type="text/javascript">
      var DOCUMENTATION_OPTIONS = {
        URL_ROOT:    '',
        VERSION:     '6',
        COLLAPSE_INDEX: false,
        FILE_SUFFIX: '.html',
        HAS_SOURCE:  true
      };
    </script>
    <script type="text/javascript" src="_static/jquery.js"></script>
    <script type="text/javascript" src="_static/underscore.js"></script>
    <script type="text/javascript" src="_static/doctools.js"></script>
    <link rel="top" title="gcc 6 documentation" href="index.html" />
    <link rel="up" title="Known Causes of Trouble with GCC" href="known-causes-of-trouble-with-gcc.html" />
    <link rel="next" title="Incompatibilities of GCC" href="incompatibilities-of-gcc.html" />
    <link rel="prev" title="Actual Bugs We Haven’t Fixed Yet" href="actual-bugs-we-haven&#39;t-fixed-yet.html" /> 
  </head>
  <body>
    <div class="related">
      <h3>Navigation</h3>
      <ul>
        <li class="right" style="margin-right: 10px">
          <a href="genindex.html" title="General Index"
             accesskey="I">index</a></li>
        <li class="right" >
          <a href="incompatibilities-of-gcc.html" title="Incompatibilities of GCC"
             accesskey="N">next</a> |</li>
        <li class="right" >
          <a href="actual-bugs-we-haven't-fixed-yet.html" title="Actual Bugs We Haven’t Fixed Yet"
             accesskey="P">previous</a> |</li>
        <li><a href="index.html">gcc 6 documentation</a> &raquo;</li>
          <li><a href="gcc.html" >Introduction</a> &raquo;</li>
          <li><a href="known-causes-of-trouble-with-gcc.html" accesskey="U">Known Causes of Trouble with GCC</a> &raquo;</li> 
      </ul>
    </div>
      <div class="sphinxsidebar">
        <div class="sphinxsidebarwrapper">
  <h4>Previous topic</h4>
  <p class="topless"><a href="actual-bugs-we-haven&#39;t-fixed-yet.html"
                        title="previous chapter">Actual Bugs We Haven&#8217;t Fixed Yet</a></p>
  <h4>Next topic</h4>
  <p class="topless"><a href="incompatibilities-of-gcc.html"
                        title="next chapter">Incompatibilities of GCC</a></p>
  <h3>This Page</h3>
  <ul class="this-page-menu">
    <li><a href="_sources/interoperation.txt"
           rel="nofollow">Show Source</a></li>
  </ul>
<div id="searchbox" style="display: none">
  <h3>Quick search</h3>
    <form class="search" action="search.html" method="get">
      <input type="text" name="q" />
      <input type="submit" value="Go" />
      <input type="hidden" name="check_keywords" value="yes" />
      <input type="hidden" name="area" value="default" />
    </form>
    <p class="searchtip" style="font-size: 90%">
    Enter search terms or a module, class or function name.
    </p>
</div>
<script type="text/javascript">$('#searchbox').show(0);</script>
        </div>
      </div>

    <div class="document">
      <div class="documentwrapper">
        <div class="bodywrapper">
          <div class="body">
            
  <div class="section" id="interoperation">
<span id="id1"></span><h1>Interoperation<a class="headerlink" href="#interoperation" title="Permalink to this headline">¶</a></h1>
<p>This section lists various difficulties encountered in using GCC
together with other compilers or with the assemblers, linkers,
libraries and debuggers on certain systems.</p>
<ul>
<li><p class="first">On many platforms, GCC supports a different ABI for C++ than do other
compilers, so the object files compiled by GCC cannot be used with object
files generated by another C++ compiler.</p>
<p>An area where the difference is most apparent is name mangling.  The use
of different name mangling is intentional, to protect you from more subtle
problems.
Compilers differ as to many internal details of C++ implementation,
including: how class instances are laid out, how multiple inheritance is
implemented, and how virtual function calls are handled.  If the name
encoding were made the same, your programs would link against libraries
provided from other compilers-but the programs would then crash when
run.  Incompatible libraries are then detected at link time, rather than
at run time.</p>
</li>
<li><p class="first">On some BSD systems, including some versions of Ultrix, use of profiling
causes static variable destructors (currently used only in C++) not to
be run.</p>
</li>
<li><p class="first">On a SPARC, GCC aligns all values of type <tt class="docutils literal"><span class="pre">double</span></tt> on an 8-byte
boundary, and it expects every <tt class="docutils literal"><span class="pre">double</span></tt> to be so aligned.  The Sun
compiler usually gives <tt class="docutils literal"><span class="pre">double</span></tt> values 8-byte alignment, with one
exception: function arguments of type <tt class="docutils literal"><span class="pre">double</span></tt> may not be aligned.</p>
<p>As a result, if a function compiled with Sun CC takes the address of an
argument of type <tt class="docutils literal"><span class="pre">double</span></tt> and passes this pointer of type
<tt class="docutils literal"><span class="pre">double</span> <span class="pre">*</span></tt> to a function compiled with GCC, dereferencing the
pointer may cause a fatal signal.</p>
<p>One way to solve this problem is to compile your entire program with GCC.
Another solution is to modify the function that is compiled with
Sun CC to copy the argument into a local variable; local variables
are always properly aligned.  A third solution is to modify the function
that uses the pointer to dereference it via the following function
<tt class="docutils literal"><span class="pre">access_double</span></tt> instead of directly with <a href="#id2"><span class="problematic" id="id3">*</span></a>:</p>
<div class="highlight-c++"><div class="highlight"><pre><span class="kr">inline</span> <span class="kt">double</span>
<span class="nf">access_double</span> <span class="p">(</span><span class="kt">double</span> <span class="o">*</span><span class="n">unaligned_ptr</span><span class="p">)</span>
<span class="p">{</span>
  <span class="k">union</span> <span class="n">d2i</span> <span class="p">{</span> <span class="kt">double</span> <span class="n">d</span><span class="p">;</span> <span class="kt">int</span> <span class="n">i</span><span class="p">[</span><span class="mi">2</span><span class="p">];</span> <span class="p">};</span>

  <span class="k">union</span> <span class="n">d2i</span> <span class="o">*</span><span class="n">p</span> <span class="o">=</span> <span class="p">(</span><span class="k">union</span> <span class="n">d2i</span> <span class="o">*</span><span class="p">)</span> <span class="n">unaligned_ptr</span><span class="p">;</span>
  <span class="k">union</span> <span class="n">d2i</span> <span class="n">u</span><span class="p">;</span>

  <span class="n">u</span><span class="p">.</span><span class="n">i</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="o">=</span> <span class="n">p</span><span class="o">-&gt;</span><span class="n">i</span><span class="p">[</span><span class="mi">0</span><span class="p">];</span>
  <span class="n">u</span><span class="p">.</span><span class="n">i</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span> <span class="o">=</span> <span class="n">p</span><span class="o">-&gt;</span><span class="n">i</span><span class="p">[</span><span class="mi">1</span><span class="p">];</span>

  <span class="k">return</span> <span class="n">u</span><span class="p">.</span><span class="n">d</span><span class="p">;</span>
<span class="p">}</span>
</pre></div>
</div>
<p>Storing into the pointer can be done likewise with the same union.</p>
</li>
<li><p class="first">On Solaris, the <tt class="docutils literal"><span class="pre">malloc</span></tt> function in the libmalloc.a library
may allocate memory that is only 4 byte aligned.  Since GCC on the
SPARC assumes that doubles are 8 byte aligned, this may result in a
fatal signal if doubles are stored in memory allocated by the
libmalloc.a library.</p>
<p>The solution is to not use the libmalloc.a library.  Use instead
<tt class="docutils literal"><span class="pre">malloc</span></tt> and related functions from libc.a; they do not have
this problem.</p>
</li>
<li><p class="first">On the HP PA machine, ADB sometimes fails to work on functions compiled
with GCC.  Specifically, it fails to work on functions that use
<tt class="docutils literal"><span class="pre">alloca</span></tt> or variable-size arrays.  This is because GCC doesn&#8217;t
generate HP-UX unwind descriptors for such functions.  It may even be
impossible to generate them.</p>
</li>
<li><p class="first">Debugging (<a class="reference internal" href="options-for-debugging-your-program-or-gcc.html#cmdoption-g"><em class="xref std std-option">-g</em></a>) is not supported on the HP PA machine, unless you use
the preliminary GNU tools.</p>
</li>
<li><p class="first">Taking the address of a label may generate errors from the HP-UX
PA assembler.  GAS for the PA does not have this problem.</p>
</li>
<li><p class="first">Using floating point parameters for indirect calls to static functions
will not work when using the HP assembler.  There simply is no way for GCC
to specify what registers hold arguments for static functions when using
the HP assembler.  GAS for the PA does not have this problem.</p>
</li>
<li><p class="first">In extremely rare cases involving some very large functions you may
receive errors from the HP linker complaining about an out of bounds
unconditional branch offset.  This used to occur more often in previous
versions of GCC, but is now exceptionally rare.  If you should run
into it, you can work around by making your function smaller.</p>
</li>
<li><p class="first">GCC compiled code sometimes emits warnings from the HP-UX assembler of
the form:</p>
<div class="highlight-c++"><div class="highlight"><pre><span class="p">(</span><span class="n">warning</span><span class="p">)</span> <span class="n">Use</span> <span class="n">of</span> <span class="n">GR3</span> <span class="n">when</span>
  <span class="n">frame</span> <span class="o">&gt;=</span> <span class="mi">8192</span> <span class="n">may</span> <span class="n">cause</span> <span class="n">conflict</span><span class="p">.</span>
</pre></div>
</div>
<p>These warnings are harmless and can be safely ignored.</p>
</li>
<li><p class="first">In extremely rare cases involving some very large functions you may
receive errors from the AIX Assembler complaining about a displacement
that is too large.  If you should run into it, you can work around by
making your function smaller.</p>
</li>
<li><p class="first">The libstdc++.a library in GCC relies on the SVR4 dynamic
linker semantics which merges global symbols between libraries and
applications, especially necessary for C++ streams functionality.
This is not the default behavior of AIX shared libraries and dynamic
linking.  libstdc++.a is built on AIX with &#8216;runtime-linking&#8217;
enabled so that symbol merging can occur.  To utilize this feature,
the application linked with libstdc++.a must include the
<em class="xref std std-option">-Wl,-brtl</em> flag on the link line.  G++ cannot impose this
because this option may interfere with the semantics of the user
program and users may not always use g++ to link his or her
application.  Applications are not required to use the
<em class="xref std std-option">-Wl,-brtl</em> flag on the link line-the rest of the
libstdc++.a library which is not dependent on the symbol
merging semantics will continue to function correctly.</p>
</li>
<li><p class="first">An application can interpose its own definition of functions for
functions invoked by libstdc++.a with &#8216;runtime-linking&#8217;
enabled on AIX.  To accomplish this the application must be linked
with &#8216;runtime-linking&#8217; option and the functions explicitly must be
exported by the application (<em class="xref std std-option">-Wl,-brtl,-bE:exportfile</em>).</p>
</li>
<li><p class="first">AIX on the RS/6000 provides support (NLS) for environments outside of
the United States.  Compilers and assemblers use NLS to support
locale-specific representations of various objects including
floating-point numbers (. vs , for separating decimal
fractions).  There have been problems reported where the library linked
with GCC does not produce the same floating-point formats that the
assembler accepts.  If you have this problem, set the <span class="target" id="index-0"></span><a class="reference internal" href="environment-variables-affecting-gcc.html#envvar-LANG"><tt class="xref std std-envvar docutils literal"><span class="pre">LANG</span></tt></a>
environment variable to C or En_US.</p>
</li>
<li><p id="index-1">Even if you specify <a class="reference internal" href="options-controlling-the-preprocessor.html#cmdoption-fdollars-in-identifiers"><em class="xref std std-option">-fdollars-in-identifiers</em></a>,
you cannot successfully use $ in identifiers on the RS/6000 due
to a restriction in the IBM assembler.  GAS supports these
identifiers.</p>
</li>
</ul>
</div>


          </div>
        </div>
      </div>
      <div class="clearer"></div>
    </div>
    <div class="related">
      <h3>Navigation</h3>
      <ul>
        <li class="right" style="margin-right: 10px">
          <a href="genindex.html" title="General Index"
             >index</a></li>
        <li class="right" >
          <a href="incompatibilities-of-gcc.html" title="Incompatibilities of GCC"
             >next</a> |</li>
        <li class="right" >
          <a href="actual-bugs-we-haven't-fixed-yet.html" title="Actual Bugs We Haven’t Fixed Yet"
             >previous</a> |</li>
        <li><a href="index.html">gcc 6 documentation</a> &raquo;</li>
          <li><a href="gcc.html" >Introduction</a> &raquo;</li>
          <li><a href="known-causes-of-trouble-with-gcc.html" >Known Causes of Trouble with GCC</a> &raquo;</li> 
      </ul>
    </div>
    <div class="footer">
        &copy; Copyright 2015, gcc peeps.
      Created using <a href="http://sphinx.pocoo.org/">Sphinx</a> 1.1.3.
    </div>
  </body>
</html>