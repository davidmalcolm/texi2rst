

<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN"
  "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">


<html xmlns="http://www.w3.org/1999/xhtml">
  <head>
    <meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
    
    <title>Using Precompiled Headers &mdash; gcc 6 documentation</title>
    
    <link rel="stylesheet" href="_static/sphinxdoc.css" type="text/css" />
    <link rel="stylesheet" href="_static/pygments.css" type="text/css" />
    
    <script type="text/javascript">
      var DOCUMENTATION_OPTIONS = {
        URL_ROOT:    '',
        VERSION:     '6',
        COLLAPSE_INDEX: false,
        FILE_SUFFIX: '.html',
        HAS_SOURCE:  true
      };
    </script>
    <script type="text/javascript" src="_static/jquery.js"></script>
    <script type="text/javascript" src="_static/underscore.js"></script>
    <script type="text/javascript" src="_static/doctools.js"></script>
    <link rel="top" title="gcc 6 documentation" href="index.html" />
    <link rel="up" title="GCC Command Options" href="gcc-command-options.html" />
    <link rel="next" title="C Implementation-Defined Behavior" href="c-implementation-defined-behavior.html" />
    <link rel="prev" title="Environment Variables Affecting GCC" href="environment-variables-affecting-gcc.html" /> 
  </head>
  <body>
    <div class="related">
      <h3>Navigation</h3>
      <ul>
        <li class="right" style="margin-right: 10px">
          <a href="genindex.html" title="General Index"
             accesskey="I">index</a></li>
        <li class="right" >
          <a href="c-implementation-defined-behavior.html" title="C Implementation-Defined Behavior"
             accesskey="N">next</a> |</li>
        <li class="right" >
          <a href="environment-variables-affecting-gcc.html" title="Environment Variables Affecting GCC"
             accesskey="P">previous</a> |</li>
        <li><a href="index.html">gcc 6 documentation</a> &raquo;</li>
          <li><a href="gcc.html" >Introduction</a> &raquo;</li>
          <li><a href="gcc-command-options.html" accesskey="U">GCC Command Options</a> &raquo;</li> 
      </ul>
    </div>
      <div class="sphinxsidebar">
        <div class="sphinxsidebarwrapper">
  <h4>Previous topic</h4>
  <p class="topless"><a href="environment-variables-affecting-gcc.html"
                        title="previous chapter">Environment Variables Affecting GCC</a></p>
  <h4>Next topic</h4>
  <p class="topless"><a href="c-implementation-defined-behavior.html"
                        title="next chapter">C Implementation-Defined Behavior</a></p>
  <h3>This Page</h3>
  <ul class="this-page-menu">
    <li><a href="_sources/using-precompiled-headers.txt"
           rel="nofollow">Show Source</a></li>
  </ul>
<div id="searchbox" style="display: none">
  <h3>Quick search</h3>
    <form class="search" action="search.html" method="get">
      <input type="text" name="q" />
      <input type="submit" value="Go" />
      <input type="hidden" name="check_keywords" value="yes" />
      <input type="hidden" name="area" value="default" />
    </form>
    <p class="searchtip" style="font-size: 90%">
    Enter search terms or a module, class or function name.
    </p>
</div>
<script type="text/javascript">$('#searchbox').show(0);</script>
        </div>
      </div>

    <div class="document">
      <div class="documentwrapper">
        <div class="bodywrapper">
          <div class="body">
            
  <div class="section" id="using-precompiled-headers">
<span id="precompiled-headers"></span><h1>Using Precompiled Headers<a class="headerlink" href="#using-precompiled-headers" title="Permalink to this headline">Â¶</a></h1>
<span class="target" id="index-0"></span><p id="index-1">Often large projects have many header files that are included in every
source file.  The time the compiler takes to process these header files
over and over again can account for nearly all of the time required to
build the project.  To make builds faster, GCC allows you to
<em class="dfn">precompile</em> a header file.</p>
<p>To create a precompiled header file, simply compile it as you would any
other file, if necessary using the <a class="reference internal" href="options-controlling-the-preprocessor.html#cmdoption-x"><em class="xref std std-option">-x</em></a> option to make the driver
treat it as a C or C++ header file.  You may want to use a
tool like <strong class="command">make</strong> to keep the precompiled header up-to-date when
the headers it contains change.</p>
<p>A precompiled header file is searched for when <tt class="docutils literal"><span class="pre">#include</span></tt> is
seen in the compilation.  As it searches for the included file
(see <em class="xref std std-ref">Search Path</em>) the
compiler looks for a precompiled header in each directory just before it
looks for the include file in that directory.  The name searched for is
the name specified in the <tt class="docutils literal"><span class="pre">#include</span></tt> with .gch appended.  If
the precompiled header file can&#8217;t be used, it is ignored.</p>
<p>For instance, if you have <tt class="docutils literal"><span class="pre">#include</span> <span class="pre">&quot;all.h&quot;</span></tt>, and you have
all.h.gch in the same directory as all.h, then the
precompiled header file is used if possible, and the original
header is used otherwise.</p>
<p>Alternatively, you might decide to put the precompiled header file in a
directory and use <a class="reference internal" href="options-controlling-the-preprocessor.html#cmdoption-I"><em class="xref std std-option">-I</em></a> to ensure that directory is searched
before (or instead of) the directory containing the original header.
Then, if you want to check that the precompiled header file is always
used, you can put a file of the same name as the original header in this
directory containing an <tt class="docutils literal"><span class="pre">#error</span></tt> command.</p>
<p>This also works with <a class="reference internal" href="options-controlling-the-preprocessor.html#cmdoption-include"><em class="xref std std-option">-include</em></a>.  So yet another way to use
precompiled headers, good for projects not designed with precompiled
header files in mind, is to simply take most of the header files used by
a project, include them from another header file, precompile that header
file, and <a class="reference internal" href="options-controlling-the-preprocessor.html#cmdoption-include"><em class="xref std std-option">-include</em></a> the precompiled header.  If the header files
have guards against multiple inclusion, they are skipped because
they&#8217;ve already been included (in the precompiled header).</p>
<p>If you need to precompile the same header file for different
languages, targets, or compiler options, you can instead make a
directory named like all.h.gch, and put each precompiled
header in the directory, perhaps using <a class="reference internal" href="options-controlling-the-preprocessor.html#cmdoption-o"><em class="xref std std-option">-o</em></a>.  It doesn&#8217;t matter
what you call the files in the directory; every precompiled header in
the directory is considered.  The first precompiled header
encountered in the directory that is valid for this compilation is
used; they&#8217;re searched in no particular order.</p>
<p>There are many other possibilities, limited only by your imagination,
good sense, and the constraints of your build system.</p>
<p>A precompiled header file can be used only when these conditions apply:</p>
<ul>
<li><p class="first">Only one precompiled header can be used in a particular compilation.</p>
</li>
<li><p class="first">A precompiled header can&#8217;t be used once the first C token is seen.  You
can have preprocessor directives before a precompiled header; you cannot
include a precompiled header from inside another header.</p>
</li>
<li><p class="first">The precompiled header file must be produced for the same language as
the current compilation.  You can&#8217;t use a C precompiled header for a C++
compilation.</p>
</li>
<li><p class="first">The precompiled header file must have been produced by the same compiler
binary as the current compilation is using.</p>
</li>
<li><p class="first">Any macros defined before the precompiled header is included must
either be defined in the same way as when the precompiled header was
generated, or must not affect the precompiled header, which usually
means that they don&#8217;t appear in the precompiled header at all.</p>
<p>The <a class="reference internal" href="options-controlling-the-preprocessor.html#cmdoption-D"><em class="xref std std-option">-D</em></a> option is one way to define a macro before a
precompiled header is included; using a <tt class="docutils literal"><span class="pre">#define</span></tt> can also do it.
There are also some options that define macros implicitly, like
<a class="reference internal" href="options-that-control-optimization.html#cmdoption-O"><em class="xref std std-option">-O</em></a> and <em class="xref std std-option">-Wdeprecated</em>; the same rule applies to macros
defined this way.</p>
</li>
<li><p class="first">If debugging information is output when using the precompiled
header, using <a class="reference internal" href="options-for-debugging-your-program-or-gcc.html#cmdoption-g"><em class="xref std std-option">-g</em></a> or similar, the same kind of debugging information
must have been output when building the precompiled header.  However,
a precompiled header built using <a class="reference internal" href="options-for-debugging-your-program-or-gcc.html#cmdoption-g"><em class="xref std std-option">-g</em></a> can be used in a compilation
when no debugging information is being output.</p>
</li>
<li><p class="first">The same <em class="xref std std-option">-m</em> options must generally be used when building
and using the precompiled header.  See <a class="reference internal" href="hardware-models-and-configurations.html#submodel-options"><em>Hardware Models and Configurations</em></a>,
for any cases where this rule is relaxed.</p>
</li>
<li><p class="first">Each of the following options must be the same when building and using
the precompiled header:</p>
<p><a class="reference internal" href="options-for-code-generation-conventions.html#cmdoption-fexceptions"><em class="xref std std-option">-fexceptions</em></a></p>
</li>
<li><p class="first">Some other command-line options starting with <em class="xref std std-option">-f</em>,
<a class="reference internal" href="options-for-debugging-your-program-or-gcc.html#cmdoption-p"><em class="xref std std-option">-p</em></a>, or <a class="reference internal" href="options-that-control-optimization.html#cmdoption-O"><em class="xref std std-option">-O</em></a> must be defined in the same way as when
the precompiled header was generated.  At present, it&#8217;s not clear
which options are safe to change and which are not; the safest choice
is to use exactly the same options when generating and using the
precompiled header.  The following are known to be safe:</p>
<p><em class="xref std std-option">-fmessage-length=</em>  <a class="reference internal" href="options-controlling-the-preprocessor.html#cmdoption-fpreprocessed"><em class="xref std std-option">-fpreprocessed</em></a>  <em class="xref std std-option">-fsched-interblock</em>
<em class="xref std std-option">-fsched-spec</em>  <a class="reference internal" href="options-that-control-optimization.html#cmdoption-fsched-spec-load"><em class="xref std std-option">-fsched-spec-load</em></a>  <a class="reference internal" href="options-that-control-optimization.html#cmdoption-fsched-spec-load-dangerous"><em class="xref std std-option">-fsched-spec-load-dangerous</em></a>
<em class="xref std std-option">-fsched-verbose=```number`</em>  <a class="reference internal" href="options-that-control-optimization.html#cmdoption-fschedule-insns"><em class="xref std std-option">-fschedule-insns</em></a>  <em class="xref std std-option">-fvisibility=</em>
<a class="reference internal" href="options-to-request-or-suppress-warnings.html#cmdoption-pedantic-errors"><em class="xref std std-option">-pedantic-errors</em></a></p>
</li>
</ul>
<p>For all of these except the last, the compiler automatically
ignores the precompiled header if the conditions aren&#8217;t met.  If you
find an option combination that doesn&#8217;t work and doesn&#8217;t cause the
precompiled header to be ignored, please consider filing a bug report,
see Bugs.</p>
<p>If you do use differing options when generating and using the
precompiled header, the actual behavior is a mixture of the
behavior for the options.  For instance, if you use <a class="reference internal" href="options-for-debugging-your-program-or-gcc.html#cmdoption-g"><em class="xref std std-option">-g</em></a> to
generate the precompiled header but not when using it, you may or may
not get debugging information for routines in the precompiled header.</p>
</div>


          </div>
        </div>
      </div>
      <div class="clearer"></div>
    </div>
    <div class="related">
      <h3>Navigation</h3>
      <ul>
        <li class="right" style="margin-right: 10px">
          <a href="genindex.html" title="General Index"
             >index</a></li>
        <li class="right" >
          <a href="c-implementation-defined-behavior.html" title="C Implementation-Defined Behavior"
             >next</a> |</li>
        <li class="right" >
          <a href="environment-variables-affecting-gcc.html" title="Environment Variables Affecting GCC"
             >previous</a> |</li>
        <li><a href="index.html">gcc 6 documentation</a> &raquo;</li>
          <li><a href="gcc.html" >Introduction</a> &raquo;</li>
          <li><a href="gcc-command-options.html" >GCC Command Options</a> &raquo;</li> 
      </ul>
    </div>
    <div class="footer">
        &copy; Copyright 2015, gcc peeps.
      Created using <a href="http://sphinx.pocoo.org/">Sphinx</a> 1.1.3.
    </div>
  </body>
</html>