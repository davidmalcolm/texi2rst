

<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN"
  "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">


<html xmlns="http://www.w3.org/1999/xhtml">
  <head>
    <meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
    
    <title>Unnamed Structure and Union Fields &mdash; gcc 6 documentation</title>
    
    <link rel="stylesheet" href="_static/sphinxdoc.css" type="text/css" />
    <link rel="stylesheet" href="_static/pygments.css" type="text/css" />
    
    <script type="text/javascript">
      var DOCUMENTATION_OPTIONS = {
        URL_ROOT:    '',
        VERSION:     '6',
        COLLAPSE_INDEX: false,
        FILE_SUFFIX: '.html',
        HAS_SOURCE:  true
      };
    </script>
    <script type="text/javascript" src="_static/jquery.js"></script>
    <script type="text/javascript" src="_static/underscore.js"></script>
    <script type="text/javascript" src="_static/doctools.js"></script>
    <link rel="top" title="gcc 6 documentation" href="index.html" />
    <link rel="up" title="Extensions to the C Language Family" href="extensions-to-the-c-language-family.html" />
    <link rel="next" title="Thread-Local Storage" href="thread-local-storage.html" />
    <link rel="prev" title="Pragmas Accepted by GCC" href="pragmas-accepted-by-gcc.html" /> 
  </head>
  <body>
    <div class="related">
      <h3>Navigation</h3>
      <ul>
        <li class="right" style="margin-right: 10px">
          <a href="genindex.html" title="General Index"
             accesskey="I">index</a></li>
        <li class="right" >
          <a href="thread-local-storage.html" title="Thread-Local Storage"
             accesskey="N">next</a> |</li>
        <li class="right" >
          <a href="pragmas-accepted-by-gcc.html" title="Pragmas Accepted by GCC"
             accesskey="P">previous</a> |</li>
        <li><a href="index.html">gcc 6 documentation</a> &raquo;</li>
          <li><a href="gcc.html" >Introduction</a> &raquo;</li>
          <li><a href="extensions-to-the-c-language-family.html" accesskey="U">Extensions to the C Language Family</a> &raquo;</li> 
      </ul>
    </div>
      <div class="sphinxsidebar">
        <div class="sphinxsidebarwrapper">
  <h4>Previous topic</h4>
  <p class="topless"><a href="pragmas-accepted-by-gcc.html"
                        title="previous chapter">Pragmas Accepted by GCC</a></p>
  <h4>Next topic</h4>
  <p class="topless"><a href="thread-local-storage.html"
                        title="next chapter">Thread-Local Storage</a></p>
  <h3>This Page</h3>
  <ul class="this-page-menu">
    <li><a href="_sources/unnamed-structure-and-union-fields.txt"
           rel="nofollow">Show Source</a></li>
  </ul>
<div id="searchbox" style="display: none">
  <h3>Quick search</h3>
    <form class="search" action="search.html" method="get">
      <input type="text" name="q" />
      <input type="submit" value="Go" />
      <input type="hidden" name="check_keywords" value="yes" />
      <input type="hidden" name="area" value="default" />
    </form>
    <p class="searchtip" style="font-size: 90%">
    Enter search terms or a module, class or function name.
    </p>
</div>
<script type="text/javascript">$('#searchbox').show(0);</script>
        </div>
      </div>

    <div class="document">
      <div class="documentwrapper">
        <div class="bodywrapper">
          <div class="body">
            
  <div class="section" id="unnamed-structure-and-union-fields">
<h1>Unnamed Structure and Union Fields<a class="headerlink" href="#unnamed-structure-and-union-fields" title="Permalink to this headline">Â¶</a></h1>
<p><tt class="docutils literal"><span class="pre">struct</span></tt>
<tt class="docutils literal"><span class="pre">union</span></tt></p>
<p>As permitted by ISO C11 and for compatibility with other compilers,
GCC allows you to define
a structure or union that contains, as fields, structures and unions
without names.  For example:</p>
<div class="highlight-c++"><div class="highlight"><pre><span class="k">struct</span> <span class="p">{</span>
  <span class="kt">int</span> <span class="n">a</span><span class="p">;</span>
  <span class="k">union</span> <span class="p">{</span>
    <span class="kt">int</span> <span class="n">b</span><span class="p">;</span>
    <span class="kt">float</span> <span class="n">c</span><span class="p">;</span>
  <span class="p">};</span>
  <span class="kt">int</span> <span class="n">d</span><span class="p">;</span>
<span class="p">}</span> <span class="n">foo</span><span class="p">;</span>
</pre></div>
</div>
<p>In this example, you are able to access members of the unnamed
union with code like foo.b.  Note that only unnamed structs and
unions are allowed, you may not have, for example, an unnamed
<tt class="docutils literal"><span class="pre">int</span></tt>.</p>
<p>You must never create such structures that cause ambiguous field definitions.
For example, in this structure:</p>
<div class="highlight-c++"><div class="highlight"><pre><span class="k">struct</span> <span class="p">{</span>
  <span class="kt">int</span> <span class="n">a</span><span class="p">;</span>
  <span class="k">struct</span> <span class="p">{</span>
    <span class="kt">int</span> <span class="n">a</span><span class="p">;</span>
  <span class="p">};</span>
<span class="p">}</span> <span class="n">foo</span><span class="p">;</span>
</pre></div>
</div>
<p>it is ambiguous which <tt class="docutils literal"><span class="pre">a</span></tt> is being referred to with foo.a.
The compiler gives errors for such constructs.</p>
<p id="index-0">Unless <a class="reference internal" href="options-controlling-c-dialect.html#cmdoption-fms-extensions"><em class="xref std std-option">-fms-extensions</em></a> is used, the unnamed field must be a
structure or union definition without a tag (for example, struct
{ int a; };).  If <a class="reference internal" href="options-controlling-c-dialect.html#cmdoption-fms-extensions"><em class="xref std std-option">-fms-extensions</em></a> is used, the field may
also be a definition with a tag such as struct foo { int a;
};, a reference to a previously defined structure or union such as
struct foo;, or a reference to a <tt class="docutils literal"><span class="pre">typedef</span></tt> name for a
previously defined structure or union type.</p>
<p id="index-1">The option <a class="reference internal" href="options-controlling-c-dialect.html#cmdoption-fplan9-extensions"><em class="xref std std-option">-fplan9-extensions</em></a> enables
<a class="reference internal" href="options-controlling-c-dialect.html#cmdoption-fms-extensions"><em class="xref std std-option">-fms-extensions</em></a> as well as two other extensions.  First, a
pointer to a structure is automatically converted to a pointer to an
anonymous field for assignments and function calls.  For example:</p>
<div class="highlight-c++"><div class="highlight"><pre><span class="k">struct</span> <span class="n">s1</span> <span class="p">{</span> <span class="kt">int</span> <span class="n">a</span><span class="p">;</span> <span class="p">};</span>
<span class="k">struct</span> <span class="n">s2</span> <span class="p">{</span> <span class="k">struct</span> <span class="n">s1</span><span class="p">;</span> <span class="p">};</span>
<span class="k">extern</span> <span class="kt">void</span> <span class="nf">f1</span> <span class="p">(</span><span class="k">struct</span> <span class="n">s1</span> <span class="o">*</span><span class="p">);</span>
<span class="kt">void</span> <span class="nf">f2</span> <span class="p">(</span><span class="k">struct</span> <span class="n">s2</span> <span class="o">*</span><span class="n">p</span><span class="p">)</span> <span class="p">{</span> <span class="n">f1</span> <span class="p">(</span><span class="n">p</span><span class="p">);</span> <span class="p">}</span>
</pre></div>
</div>
<p>In the call to <tt class="docutils literal"><span class="pre">f1</span></tt> inside <tt class="docutils literal"><span class="pre">f2</span></tt>, the pointer <tt class="docutils literal"><span class="pre">p</span></tt> is
converted into a pointer to the anonymous field.</p>
<p>Second, when the type of an anonymous field is a <tt class="docutils literal"><span class="pre">typedef</span></tt> for a
<tt class="docutils literal"><span class="pre">struct</span></tt> or <tt class="docutils literal"><span class="pre">union</span></tt>, code may refer to the field using the
name of the <tt class="docutils literal"><span class="pre">typedef</span></tt>.</p>
<div class="highlight-c++"><div class="highlight"><pre><span class="k">typedef</span> <span class="k">struct</span> <span class="p">{</span> <span class="kt">int</span> <span class="n">a</span><span class="p">;</span> <span class="p">}</span> <span class="n">s1</span><span class="p">;</span>
<span class="k">struct</span> <span class="n">s2</span> <span class="p">{</span> <span class="n">s1</span><span class="p">;</span> <span class="p">};</span>
<span class="n">s1</span> <span class="nf">f1</span> <span class="p">(</span><span class="k">struct</span> <span class="n">s2</span> <span class="o">*</span><span class="n">p</span><span class="p">)</span> <span class="p">{</span> <span class="k">return</span> <span class="n">p</span><span class="o">-&gt;</span><span class="n">s1</span><span class="p">;</span> <span class="p">}</span>
</pre></div>
</div>
<p>These usages are only permitted when they are not ambiguous.</p>
</div>


          </div>
        </div>
      </div>
      <div class="clearer"></div>
    </div>
    <div class="related">
      <h3>Navigation</h3>
      <ul>
        <li class="right" style="margin-right: 10px">
          <a href="genindex.html" title="General Index"
             >index</a></li>
        <li class="right" >
          <a href="thread-local-storage.html" title="Thread-Local Storage"
             >next</a> |</li>
        <li class="right" >
          <a href="pragmas-accepted-by-gcc.html" title="Pragmas Accepted by GCC"
             >previous</a> |</li>
        <li><a href="index.html">gcc 6 documentation</a> &raquo;</li>
          <li><a href="gcc.html" >Introduction</a> &raquo;</li>
          <li><a href="extensions-to-the-c-language-family.html" >Extensions to the C Language Family</a> &raquo;</li> 
      </ul>
    </div>
    <div class="footer">
        &copy; Copyright 2015, gcc peeps.
      Created using <a href="http://sphinx.pocoo.org/">Sphinx</a> 1.1.3.
    </div>
  </body>
</html>